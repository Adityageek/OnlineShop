@model OnlineShop.ViewModels.ProductViewModel

@{
    ViewBag.Title = "ViewProduct";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="~/Scripts/knockout-3.5.0.js"></script>
<script src="~/Scripts/knockout.mapping-latest.js"></script>
<script src="~/Scripts/moment.js"></script>
<h2>ViewProduct</h2>
<p>
    @Html.ActionLink("Create New", "Create")
</p>
<body>
    <div id="main">
        <table class="table" id="myTable">
            <thead>
                <tr>
                    <th>
                        @Html.DisplayNameFor(model => model.ProductTitle)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.LaunchDate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Quantity)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Mrp)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Discount)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Description)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.SellingPrice)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.Image)
                    </th>

                </tr>
            </thead>

            <tbody data-bind="foreach:ShowProduct">
                <tr data-bind="id:ProductId">
                    <td data-bind="text:ProductTitle"></td>
                    <td data-bind="date:LaunchDate"></td>
                    <td data-bind="text:Quantity"></td>
                    <td data-bind="text:Mrp"></td>
                    <td data-bind="text:Discount"></td>
                    <td data-bind="text:Description"></td>
                    <td data-bind="text:SellingPrice"></td>
                    <td><img data-bind=" attr:{src:Image}" width="100px" /></td>
                    @*<td class="ListButtons">
                            @Html.ActionLink("Add To Cart", "AddToCart", "Cart", new { data_bind = "text:ProductId, text:ProductTitle, date:LaunchDate" })

                        </td>*@
                    <td>
                        @using (Html.BeginForm("AddToCart", "Cart", FormMethod.Post))
                        {
                            <button type="submit" class="pull-right"><i class="fa fa-shopping-cart"></i>Add To Cart</button>
                            <input type="hidden" name="ProductId" data-bind="attr:{value:ProductId}" />
                            <input type="hidden" name="ProductTitle" data-bind="attr:{value:ProductTitle}" />
                            <input type="hidden" name="SellingPrice" data-bind="attr:{value:SellingPrice}" />

                        }
                    </td>
                </tr>
            </tbody>

        </table>


    </div>
    <script>
        var ShowProduct = ko.observableArray();
        getProduct = function () {
            $.getJSON('/Product/getProduct', function (data) {
                for (var i = 0; i < data.length; i++) {

                    ShowProduct.push(data[i]);

                }
            });

        }

        var ShowModel = function () {

            var self = this;
            self.ProductTitle = ko.observable();
            self.LaunchDate = ko.observable();
            self.Quantity = ko.observable();
            self.Mrp = ko.observable();
            self.Discount = ko.observable();
            self.Description = ko.observable();
            self.SellingPrice = ko.observable();
            //self.CategoryId = ko.observable();
            self.Image = ko.observable();
            //self.x = ko.observable();
        }
        ko.bindingHandlers.date = {
            update: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
                var valueUnwrapped = ko.utils.unwrapObservable(valueAccessor());
                var textContent = moment(valueUnwrapped).format("DD/MM/YYYY");
                ko.bindingHandlers.text.update(element, function () { return textContent; });
            }
        };
        var showModel = new ShowModel();
        $(document).ready(function () {
            getProduct();
            ko.applyBindings(showModel, document.getElementById("main"));
        });
    </script>
</body>
